{"ast":null,"code":"var _jsxFileName = \"/home/breno/front-end-bigbangbeer/src/pages/UserProducts/Index.jsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { allProducts } from '../../services/trybeerUserAPI';\nimport TopMenu from '../../components/TopMenu/Index';\nimport './styles.css';\nimport Loading from '../../components/Loading/Index';\n\nconst decrement = async (product, purchase, setPurchase, setTotal) => {\n  const {\n    id,\n    name,\n    image,\n    price,\n    amount\n  } = product;\n  const purchaseWithoutItem = (await purchase.filter(elem => elem.id !== product.id)) || [];\n\n  if (!amount) {\n    return;\n  }\n\n  if (amount === 1) {\n    setPurchase(purchaseWithoutItem);\n    localStorage.setItem('inProcessPurchase', JSON.stringify(purchaseWithoutItem));\n    const newtotal = purchaseWithoutItem.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n    return newtotal === 0 ? setTotal('0,00') : setTotal(newtotal);\n  }\n\n  const newAmount = parseInt(amount) - 1;\n  const newItem = {\n    id,\n    name,\n    image,\n    price,\n    amount: newAmount\n  };\n  const newPurchase = [...purchaseWithoutItem, newItem];\n  setPurchase(newPurchase);\n  localStorage.setItem('inProcessPurchase', JSON.stringify(newPurchase));\n  const newtotal = newPurchase.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n  return setTotal(newtotal);\n};\n\nconst increment = async (product, purchase, setPurchase, setTotal) => {\n  const {\n    id,\n    name,\n    image,\n    price,\n    amount\n  } = product;\n  const purchaseWithoutItem = (await purchase.filter(elem => elem.id !== product.id)) || [];\n  const newAmount = amount ? parseInt(amount) + 1 : 1;\n  const newItem = {\n    id,\n    name,\n    image,\n    price,\n    amount: newAmount\n  };\n  const newPurchase = [...purchaseWithoutItem, newItem];\n  setPurchase(newPurchase);\n  const newtotal = newPurchase.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n  localStorage.setItem('inProcessPurchase', JSON.stringify(newPurchase));\n  return setTotal(newtotal);\n};\n\nconst renderButtons = (id, e, purchase, setPurchase, setTotal) => {\n  const product = purchase.filter(e => e.id === id)[0] || e;\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"card-buttons quantity buttons_added\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => decrement(product, purchase, setPurchase, setTotal),\n    type: \"button\",\n    \"data-testid\": `${id - 1}-product-minus`,\n    className: \"product-minus\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }\n  }, \"-\"), /*#__PURE__*/React.createElement(\"span\", {\n    \"data-testid\": `${id - 1}-product-qtd`,\n    className: \"product-qtd\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }, product.amount ? product.amount : 0), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => increment(product, purchase, setPurchase, setTotal),\n    type: \"button\",\n    \"data-testid\": `${id - 1}-product-plus`,\n    className: \"product-plus\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }, \"+\"));\n};\n\nconst productsCards = (products, purchase, setPurchase, total, setTotal) => /*#__PURE__*/React.createElement(\"div\", {\n  className: \"products-container-card\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 80,\n    columnNumber: 3\n  }\n}, products.map(e => /*#__PURE__*/React.createElement(\"div\", {\n  key: e.id - 1,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 7\n  }\n}, /*#__PURE__*/React.createElement(\"div\", {\n  className: \"products-card\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 9\n  }\n}, /*#__PURE__*/React.createElement(\"img\", {\n  \"data-testid\": `${e.id - 1}-product-img`,\n  src: e.image,\n  width: \"100px\",\n  alt: e.name,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 84,\n    columnNumber: 11\n  }\n}), /*#__PURE__*/React.createElement(\"h2\", {\n  className: \"products-card-text\",\n  \"data-testid\": `${e.id - 1}-product-name`,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 85,\n    columnNumber: 11\n  }\n}, e.name), /*#__PURE__*/React.createElement(\"h3\", {\n  className: \"product-price\",\n  \"data-testid\": `${e.id - 1}-product-price`,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 86,\n    columnNumber: 11\n  }\n}, \"R$\", e.price.toFixed(2).replace('.', ',')), renderButtons(e.id, e, purchase, setPurchase, total, setTotal)))));\n\nconst cartButton = (total, clickToCart, isDisabled) => /*#__PURE__*/React.createElement(\"div\", {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 98,\n    columnNumber: 3\n  }\n}, /*#__PURE__*/React.createElement(\"button\", {\n  type: \"button\",\n  className: isDisabled() ? 'notAble' : 'checkout-bottom-btn',\n  \"data-testid\": \"checkout-bottom-btn\",\n  onClick: () => clickToCart(),\n  disabled: isDisabled(),\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 5\n  }\n}, \"Ver Carrinho\", ' ', /*#__PURE__*/React.createElement(\"h4\", {\n  \"data-testid\": \"checkout-bottom-btn-value\",\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 7\n  }\n}, \"R$\", total)));\n\nconst itensList = async setProducts => {\n  const listProducts = await allProducts();\n  setProducts(listProducts.data);\n};\n\nfunction UserProducts() {\n  const [products, setProducts] = useState([]);\n  const [purchase, setPurchase] = useState([]);\n  const [total, setTotal] = useState(0);\n  const history = useHistory();\n  useEffect(() => {\n    const actualUser = JSON.parse(localStorage.getItem('user'));\n    if (!actualUser) return window.location.assign('http://localhost:3000/login');\n    itensList(setProducts);\n    const actualPurchase = JSON.parse(localStorage.getItem('inProcessPurchase')) || [];\n    const actualTotal = actualPurchase.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n    setPurchase(actualPurchase);\n    actualTotal === 0 ? setTotal('0,00') : setTotal(actualTotal);\n  }, []);\n\n  const clickToCart = async () => {\n    history.push('/checkout');\n  };\n\n  const isDisabled = () => {\n    if (total !== '0,00') {\n      return false;\n    }\n\n    return true;\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 5\n    }\n  }, products.length === 0 && /*#__PURE__*/React.createElement(Loading, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 33\n    }\n  }), TopMenu('TryBeer'), productsCards(products, purchase, setPurchase, setTotal), cartButton(total, clickToCart, isDisabled));\n}\n\nexport default UserProducts;","map":{"version":3,"sources":["/home/breno/front-end-bigbangbeer/src/pages/UserProducts/Index.jsx"],"names":["React","useState","useEffect","useHistory","allProducts","TopMenu","Loading","decrement","product","purchase","setPurchase","setTotal","id","name","image","price","amount","purchaseWithoutItem","filter","elem","localStorage","setItem","JSON","stringify","newtotal","reduce","acc","parseFloat","toFixed","replace","newAmount","parseInt","newItem","newPurchase","increment","renderButtons","e","productsCards","products","total","map","cartButton","clickToCart","isDisabled","itensList","setProducts","listProducts","data","UserProducts","history","actualUser","parse","getItem","window","location","assign","actualPurchase","actualTotal","push","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router-dom';\nimport { allProducts } from '../../services/trybeerUserAPI';\nimport TopMenu from '../../components/TopMenu/Index';\nimport './styles.css';\nimport Loading from '../../components/Loading/Index';\n\nconst decrement = async (product, purchase, setPurchase, setTotal) => {\n  const {\n    id, name, image, price, amount,\n  } = product;\n  const purchaseWithoutItem = await purchase.filter((elem) => elem.id !== product.id) || [];\n  if (!amount) {\n    return;\n  }\n  if (amount === 1) {\n    setPurchase(purchaseWithoutItem);\n    localStorage.setItem('inProcessPurchase', JSON.stringify(purchaseWithoutItem));\n    const newtotal = purchaseWithoutItem.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n    return newtotal === 0 ? setTotal('0,00') : setTotal(newtotal);\n  }\n  const newAmount = (parseInt(amount) - 1);\n  const newItem = {\n    id, name, image, price, amount: newAmount,\n  };\n  const newPurchase = [...purchaseWithoutItem, newItem];\n  setPurchase(newPurchase);\n  localStorage.setItem('inProcessPurchase', JSON.stringify(newPurchase));\n  const newtotal = newPurchase.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n  return setTotal(newtotal);\n};\n\nconst increment = async (product, purchase, setPurchase, setTotal) => {\n  const {\n    id, name, image, price, amount,\n  } = product;\n  const purchaseWithoutItem = await purchase.filter((elem) => elem.id !== product.id) || [];\n  const newAmount = (amount) ? (parseInt(amount) + 1) : 1;\n  const newItem = {\n    id, name, image, price, amount: newAmount,\n  };\n  const newPurchase = [...purchaseWithoutItem, newItem];\n  setPurchase(newPurchase);\n  const newtotal = newPurchase.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n  localStorage.setItem('inProcessPurchase', JSON.stringify(newPurchase));\n  return setTotal(newtotal);\n};\n\nconst renderButtons = (id, e, purchase, setPurchase, setTotal) => {\n  const product = purchase.filter((e) => e.id === id)[0] || e;\n  return (\n    <div className=\"card-buttons quantity buttons_added\">\n      <button\n        onClick={ () => decrement(product, purchase, setPurchase, setTotal) }\n        type=\"button\"\n        data-testid={ `${(id - 1)}-product-minus` }\n        className=\"product-minus\"\n      >\n        -\n      </button>\n      <span\n        data-testid={ `${(id - 1)}-product-qtd` }\n        className=\"product-qtd\"\n      >\n        {(product.amount) ? product.amount : 0}\n      </span>\n      <button\n        onClick={ () => increment(product, purchase, setPurchase, setTotal) }\n        type=\"button\"\n        data-testid={ `${(id - 1)}-product-plus` }\n        className=\"product-plus\"\n      >\n        +\n      </button>\n    </div>\n  );\n};\n\nconst productsCards = (products, purchase, setPurchase, total, setTotal) => (\n  <div className=\"products-container-card\">\n    {products.map((e) => (\n      <div key={ e.id - 1 }>\n        <div className=\"products-card\">\n          <img data-testid={ `${(e.id - 1)}-product-img` } src={ e.image } width=\"100px\" alt={ e.name } />\n          <h2 className=\"products-card-text\" data-testid={ `${(e.id - 1)}-product-name` }>{e.name}</h2>\n          <h3 className=\"product-price\" data-testid={ `${(e.id - 1)}-product-price` }>\n            R$\n            {(e.price).toFixed(2).replace('.', ',')}\n          </h3>\n          {renderButtons(e.id, e, purchase, setPurchase, total, setTotal)}\n        </div>\n      </div>\n    ))}\n  </div>\n);\n\nconst cartButton = (total, clickToCart, isDisabled) => (\n  <div>\n    <button\n      type=\"button\"\n      className={ isDisabled() ? 'notAble' : 'checkout-bottom-btn' }\n      data-testid=\"checkout-bottom-btn\"\n      onClick={ () => clickToCart() }\n      disabled={ isDisabled() }\n    >\n      Ver Carrinho\n      {' '}\n      <h4 data-testid=\"checkout-bottom-btn-value\">\n        R$\n        {total}\n      </h4>\n    </button>\n  </div>\n);\n\nconst itensList = async (setProducts) => {\n  const listProducts = await allProducts();\n  setProducts(listProducts.data);\n};\n\nfunction UserProducts() {\n  const [products, setProducts] = useState([]);\n  const [purchase, setPurchase] = useState([]);\n  const [total, setTotal] = useState(0);\n  const history = useHistory();\n\n  useEffect(() => {\n    const actualUser = JSON.parse(localStorage.getItem('user'));\n    if (!actualUser) return window.location.assign('http://localhost:3000/login');\n    itensList(setProducts);\n    const actualPurchase = JSON.parse(localStorage.getItem('inProcessPurchase')) || [];\n    const actualTotal = actualPurchase.reduce((acc, elem) => (parseFloat(acc) + parseFloat(elem.price) * elem.amount).toFixed(2).replace('.', ','), 0);\n    setPurchase(actualPurchase);\n    actualTotal === 0 ? setTotal('0,00') : setTotal(actualTotal);\n  }, []);\n\n  const clickToCart = async () => {\n    history.push('/checkout');\n  };\n\n  const isDisabled = () => {\n    if (total !== '0,00') {\n      return false;\n    }\n    return true;\n  };\n\n  return (\n    <div>\n      {products.length === 0 && <Loading />}\n      {TopMenu('TryBeer')}\n      {productsCards(products, purchase, setPurchase, setTotal)}\n      {cartButton(total, clickToCart, isDisabled)}\n    </div>\n  );\n}\n\nexport default UserProducts;\n"]},"metadata":{},"sourceType":"module"}